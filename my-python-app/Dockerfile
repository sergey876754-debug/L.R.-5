# Инструкция FROM определяет базовый образ, на котором мы будем строить наш.
# python:3.9-alpine - это официальный легкий образ Python на базе Alpine Linux.
FROM python:3.9-alpine

# Инструкция WORKDIR задает рабочую директорию внутри контейнера.
# Все последующие команды (RUN, COPY, CMD) будут выполняться относительно этого пути.
WORKDIR /app

# Копируем файл с зависимостями из текущей директории на хосте (.) в рабочую директорию контейнера (/app).
# Первый путь - откуда копировать (на хосте), второй - куда (в контейнере).
COPY requirements.txt .

# Инструкция RUN выполняет команду внутри контейнера во время сборки образа.
# Здесь мы с помощью менеджера пакетов pip устанавливаем все зависимости из файла requirements.txt.
RUN pip install --no-cache-dir -r requirements.txt

# Копируем ВЕСЬ остальной код из текущей директории (.) в рабочую директорию контейнера (/app).
# Сюда попадет наш файл app.py.
COPY . .

# Инструкция EXPOSE информирует Docker, что контейнер будет слушать указанный сетевой порт во время выполнения.
# Это не пробрасывает порт автоматически на хост, а лишь является документацией.
EXPOSE 8080

# Инструкция CMD определяет команду по умолчанию, которая будет запущена при старте контейнера.
# Форма записи в виде JSON-массива называется "exec form" и является предпочтительной.
# В нашем случае это команда для запуска нашего приложения: python app.py
CMD ["python", "app.py"]